
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">

    <title>The Little Idea of Functional Programming &mdash; Jack Hsu</title>
    
    <meta name="author" content="Jack Hsu">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1">

    <link rel="shortcut icon" href="/images/profile-2.jpg">
    <link rel="apple-touch-icon" href="/images/profile-2.jpg">

    <link rel="alternate" type="application/rss+xml" title="Jack Hsu's Blog" href="http://jaysoo.ca/feed.xml">

    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,400,300,600' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" href="/assets/application-20f161f4de496d5a38240bd4ea489e87.css">
  </head>
  <body>
    <div id="fb-root"></div>

    <script>(function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=152515241476494";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>

    <nav class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <i class="fa fa-bars"></i>
          </button>
          <div class="brand" >
            <img src="/images/profile-2.jpg" alt="" />
            <a href="/">
              Jack Hsu
            </a>
          </div>
          <div class="twitter-follow">
            <a href="https://twitter.com/jay_soo" class="twitter-follow-button" data-show-count="true" data-lang="en">Follow @jay_soo</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
            <a class="github-button" href="https://github.com/jaysoo" data-count-href="/jaysoo/followers" data-count-api="/users/jaysoo#followers" data-count-aria-label="# followers on GitHub" aria-label="Follow @jaysoo on GitHub">Follow @jaysoo</a>
            <script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>
          </div>
          <div class="nav-collapse collapse">
            <ul class="nav">
              
              
              


  
    
    	
    	<li><a href="/archive.html">Archive</a></li>
    	
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
    	
    	<li><a href="/tags.html">Tags</a></li>
    	
    
  



              <li>
                <a href="http://feeds.feedburner.com/jaysoo/Trwf">
                  <i class="fa fa-rss"></i>
                </a>
              </li>
            </ul>
            <form class="navbar-search pull-right" action="/search.html" method="GET">
              <input id="q" name="q" type="text" class="search-query" placeholder="Search">
            </form>
          </div>
        </div>
      </div>
    </nav>

    <div id="main">
      <div class="container-fluid">
        <div class="content">
          
<div class="page-header">
  <h1>
    The Little Idea of Functional Programming
    
</h1>
</div>

<div class="row">
  <div class="span8">
    <div class="post-body">
      <p>A little known fact about me is that I took <a href="https://en.wikipedia.org/wiki/Wing_Chun">Wing Chun</a>
lessons for four months back in 2006. A student starting in Wing Chun will begin by learning
the first form, called <em>Siu Lim Tao</em> (小練頭). This form’s name translates to “little idea,”
and it provides the foundation in which succeeding forms and techniques depend upon.</p>

<p>I’ve spent a lot of time thinking about the <em>little ideas</em> behind the art of programming.
In particular, the topic of <strong>functional programming</strong> keeps cropping up every once in a while.
Some people love it, some people hate it, while others just have no idea what functional programming
is all about.</p>

<p>When you ask people about functional programming, you might hear jargons like <em>monads</em>, <em>morphisms</em>, or <em>semigroups</em>.
Others may say functional programming is all about <em>map-filter-reduce</em>. And you may also hear talks about <em>purity</em>,
and <em>side effects</em>.</p>

<p>What I want to do in this post is to look at a couple of simple concepts that make up the <strong>little idea
behind functional programming</strong>. I will tie the concepts back to code examples in JavaScript. There will
be some ReactJS code, so some familiarity with it helps, although not necessary.</p>

<h2 id="implementing-youtube-instant-search">Implementing YouTube instant search</h2>

<p>Before we begin exploring functional programming concepts, let’s take a look at our sample problem - a
YouTube search.</p>

<p>The YouTube search app will allow the user to type in search terms to an input box. As
the user types, video results will appear below the input box.</p>

<p><img src="/images/fp-yt.gif" alt="" /></p>

<p>OK, now we are ready to begin!</p>

<h2 id="the-little-idea">The Little Idea</h2>

<p>There are three concepts that capture the essence of functional programming.</p>

<ol>
  <li>
    <p>Data in, data out</p>
  </li>
  <li>
    <p>Code as data</p>
  </li>
  <li>
    <p>(Function) Composition all the way down</p>
  </li>
</ol>

<p>Other functional programming concepts and techniques can be built upon this <em>little idea</em>.</p>

<h3 id="concept-1---data-in-data-out">Concept #1 - Data in, data out</h3>

<p>The first concept is the <strong>separation of data and behaviour</strong>. <em>Data</em> can be transformed by
passing it as input to a <em>function</em> that outputs some other <em>data</em>. You can picture
a function as a box that take in some shape, and spits out another.</p>

<p><img src="/images/comp-1.svg" alt="" /></p>

<p>In the above illustration, function <em>f</em> takes a triangle as input, and outputs a square. Function
<em>g</em> takes in a square and outputs a triangle.</p>

<p>With this idea in mind, we can implement a couple of functions to be used in our app.</p>

<h4 id="code---mapping-search-term-to-url">Code - Mapping search term to URL</h4>

<p>As the user is typing into the input box, we need a way to use that value
and transform it to an URL to fetch the results.</p>

<p>Here, we take in a <code>String</code> as input, and ouput an <code>Url</code>. Note that <code>Url</code> is simply an alias
for <code>String</code> but has better semantics.</p>

<div class="highlight"><pre><code class="js"><span class="c1">// this type alias will only work if you use TypeScript or FlowType</span>
<span class="nx">type</span> <span class="nx">Url</span> <span class="o">=</span> <span class="nb">String</span><span class="p">;</span>

<span class="c1">// makeUrl :: String -&gt; Url</span>
<span class="kr">const</span> <span class="nx">makeUrl</span> <span class="o">=</span> <span class="p">(</span><span class="nx">term</span><span class="p">)</span> <span class="o">=&gt;</span>
  <span class="err">`</span><span class="nx">https</span><span class="o">:</span><span class="c1">//www.googleapis.com/youtube/v3/search?part=snippet&amp;maxResults=24&amp;type=video&amp;q=${term}&amp;key=&#39;xxxx&#39;`;</span>
</code></pre></div>

<p>Now that we can map the user’s input value to an URL, we can fetch an API call to fetch the response JSON.
So let’s look at the video JSON object, and how we can build <code>Video</code> objects from them.</p>

<h4 id="code---hash-to-video">Code - Hash to Video</h4>

<p>The YouTube API returns a video JSON as follows.</p>

<div class="highlight"><pre><code class="js"><span class="p">{</span>
  <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;kind&quot;</span><span class="o">:</span> <span class="s2">&quot;youtube#video&quot;</span><span class="p">,</span>
    <span class="s2">&quot;videoId&quot;</span><span class="o">:</span> <span class="s2">&quot;9Q7Vr3yQYWQ&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;snippet&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;Led Zeppelin - Stairway to Heaven Live (HD)&quot;</span><span class="p">,</span>
    <span class="p">...</span>
  <span class="p">},</span>
  <span class="s2">&quot;thumbnails&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;high&quot;</span><span class="o">:</span> <span class="p">{</span>
     <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;https://i.ytimg.com/vi/9Q7Vr3yQYWQ/hqdefault.jpg&quot;</span>
    <span class="p">},</span>
    <span class="p">...</span>
  <span class="p">},</span>
  <span class="p">...</span>
<span class="p">}</span>
</code></pre></div>

<p>Therefore, we can map it to a <code>Video</code> type as follows.</p>

<div class="highlight"><pre><code class="js"><span class="c1">// This is the tagged constructor.</span>
<span class="c1">// e.g.</span>
<span class="c1">// const v = Video(&#39;1&#39;, &#39;http://...&#39;, &#39;http://...&#39;, &#39;Some Video&#39;);</span>
<span class="c1">// v.id; //=&gt; &#39;1&#39;</span>
<span class="c1">// v.title; //=&gt; &#39;Some Video&#39;</span>
<span class="c1">// v instanceof Video; //=&gt; true</span>
<span class="kr">const</span> <span class="nx">Video</span> <span class="o">=</span> <span class="nx">daggy</span><span class="p">.</span><span class="nx">tagged</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;url&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">);</span>

<span class="c1">// toVideo :: VideoJSON -&gt; Video</span>
<span class="kr">const</span> <span class="nx">toVideo</span> <span class="o">=</span> <span class="nx">json</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="p">{</span>
    <span class="nx">id</span><span class="o">:</span> <span class="p">{</span> <span class="nx">videoId</span> <span class="p">},</span>
    <span class="nx">snippet</span><span class="o">:</span> <span class="p">{</span> <span class="nx">thumbnails</span><span class="o">:</span> <span class="p">{</span> <span class="nx">high</span><span class="o">:</span> <span class="p">{</span> <span class="nx">url</span><span class="o">:</span> <span class="nx">thumbnail</span> <span class="p">}</span> <span class="p">},</span> <span class="nx">title</span> <span class="p">}</span>
  <span class="p">}</span> <span class="o">=</span> <span class="nx">json</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">Video</span><span class="p">(</span><span class="nx">videoId</span><span class="p">,</span> <span class="nx">thumbnail</span><span class="p">,</span> <span class="err">`</span><span class="nx">https</span><span class="o">:</span><span class="c1">//www.youtube.com/watch?v=${videoId}`, title);</span>
<span class="p">};</span>
</code></pre></div>

<div class="alert alert-info">
<strong>Note:</strong> I am using Haskell's type declaration notation in the comments above
the functions (e.g. <code>toVideo :: JSON -&gt; Video</code>). It describes the input and output of the
declared function.
</div>

<h3 id="concept-2---code-as-data">Concept #2 - Code as data</h3>

<p>The second concept is more commonly referred to as <strong>higher-order functions</strong>. It simply means that
functions can be used as input to other functions; and that functions can output new functions.</p>

<p>For example, given the <code>toVideo :: JSON -&gt; Video</code> function above, we can use it to map over an array
of JSON objects.</p>

<div class="highlight"><pre><code class="js"><span class="c1">// Array of JSON objects</span>
<span class="kr">const</span> <span class="nx">jsonObjects</span> <span class="o">=</span> <span class="p">[{</span> <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="p">...</span> <span class="p">},</span> <span class="p">{</span> <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="p">...</span> <span class="p">},</span> <span class="p">...];</span>

<span class="c1">// Map over them to create array of Video.</span>
<span class="kr">const</span> <span class="nx">videos</span> <span class="o">=</span> <span class="nx">jsonObjects</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">toVideo</span><span class="p">);</span>

<span class="nx">videos</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">id</span><span class="p">;</span> <span class="c1">//=&gt; &quot;1&quot;</span>
<span class="nx">videos</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">id</span><span class="p">;</span> <span class="c1">//=&gt; &quot;2&quot;</span>
<span class="nx">videos</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">id</span><span class="p">;</span> <span class="c1">//=&gt; &quot;3&quot;</span>
</code></pre></div>

<p>Here, the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map"><code>Array.prototype.map</code></a>
method takes in a transformation function as input, and returns a new array with the original elements
transformed by the input function.</p>

<p>The downside of the <code>Array.prototype.map</code> method is that you can only call it in the context of the input data. As
an alternative, we can use Ramda’s <a href="http://ramdajs.com/0.19.0/docs/#map"><code>map</code></a> function, which will
take an a transformation function as input (same as before), and then output a new function that can be called with
mappable objects (such as Array).</p>

<div class="highlight"><pre><code class="js"><span class="kr">const</span> <span class="nx">mapVideos</span> <span class="o">=</span> <span class="nx">map</span><span class="p">(</span><span class="nx">toVideo</span><span class="p">);</span>

<span class="nx">mapVideos</span><span class="p">(</span><span class="nx">jsonObjects</span><span class="p">);</span> <span class="c1">//=&gt; [Video(&quot;1&quot;), Video(&quot;2&quot;), Video(&quot;3&quot;)]</span>
<span class="nx">mapVideos</span><span class="p">([]);</span> <span class="c1">//=&gt; []</span>
<span class="nx">mapVideos</span><span class="p">([{</span> <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;4&quot;</span> <span class="p">}]);</span> <span class="c1">//=&gt; [Video(&quot;4&quot;)]</span>
</code></pre></div>

<p>This new <code>mapVideos</code> function is now completely modular and can be used with any array containing video JSON objects
to get an array of Video objects.</p>

<div class="alert alert-info">
<p>
  <strong>Note:</strong> The output function from <code>map</code> is called a <a href="http://clojure.org/transducers">transducer</a>.
  Transducers are composable transformations that are decoupled from input data. You can watch Rich Hickey's
  <a href="https://www.youtube.com/watch?v=6mTbuzafcII">talk on transducers</a> to learn more about them.
</p>
</div>

<h3 id="concept-3---composition-all-the-way-down">Concept #3 - Composition all the way down</h3>

<p>The third concept is that we can <strong>compose</strong> two functions (<em>f</em> and <em>g</em>) together (<em>f</em> ∘ <em>g</em>) as long
as <em>f</em>’s output matches <em>g</em>’s input.</p>

<p><img src="/images/comp-2.svg" alt="" /></p>

<p>In the above illustration, we created a new function <em>h</em> that composes <em>f</em> and <em>g</em>. This new function takes
a triangle as input (input of <em>f</em>) and outputs a circle (output of <em>g</em>). We can describe this in JavaScript
using the <a href="http://ramdajs.com/0.19.0/docs/#compose"><code>compose</code></a> function.</p>

<div class="highlight"><pre><code class="js"><span class="kr">const</span> <span class="nx">h</span> <span class="o">=</span> <span class="nx">compose</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span> <span class="nx">g</span><span class="p">);</span>
</code></pre></div>

<p>Taking this idea further, if we had another <em>red</em> function as follows – taking in a nested data that includes triangle, then outputs
triangle.</p>

<p><img src="/images/comp-4.svg" alt="" /></p>

<p>Then, we can <strong>compose</strong> <em>red</em> and <em>h</em> together to take in the nested data, and output circle.</p>

<p><img src="/images/comp-5.svg" alt="" /></p>

<p>This allows use to start with simple functions and use composition to build up more powerful functions.
The advantage of this approach is that the functions are completely modular. All you have to do is make
sure that the inputs and outputs match while composing.</p>

<p>So, let’s compose a few functions for our app!</p>

<h4 id="code---mapping-json-response-to-videos">Code - Mapping JSON response to videos</h4>

<p>The <code>mapVideos</code> function that we previously implemented takes an array of video JSON objects as input, and
ouputs an array of Video objects (<code>mapVideos :: [VideoJSON] -&gt; [Video]</code>). However, the YouTube API actually nests the array of video
JSON objects inside a structure like this:</p>

<div class="highlight"><pre><code class="js"><span class="p">{</span>
  <span class="p">...</span>
    <span class="s2">&quot;items&quot;</span><span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span> <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="p">...</span> <span class="p">},</span>
      <span class="p">...</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

<p>We can retrieve the video JSON objects with the <a href="http://ramdajs.com/0.19.0/docs/#prop"><code>prop</code></a> function, which
allows use to get a property (by name) from an object.</p>

<div class="highlight"><pre><code class="js"><span class="nx">prop</span><span class="p">(</span><span class="s1">&#39;items&#39;</span><span class="p">)({</span> <span class="nx">items</span><span class="o">:</span> <span class="p">[{</span> <span class="nx">id</span><span class="o">:</span> <span class="mi">1</span> <span class="p">}]</span> <span class="p">});</span> <span class="c1">//=&gt; [{ id: 1}]</span>
<span class="nx">prop</span><span class="p">(</span><span class="s1">&#39;items&#39;</span><span class="p">)({</span> <span class="nx">items</span><span class="o">:</span> <span class="p">[]</span> <span class="p">});</span> <span class="c1">//=&gt; []</span>
</code></pre></div>

<p>Now, if we pass the response JSON to <code>prop('items')</code>, we will get an array of video JSON objects, which
is exactly what <code>mapVideos</code> takes as input. This is all we need to define the <code>toVideos</code> function.</p>

<div class="highlight"><pre><code class="js"><span class="c1">// toVideos :: JSON -&gt; [Video]</span>
<span class="kr">const</span> <span class="nx">toVideos</span> <span class="o">=</span> <span class="nx">compose</span><span class="p">(</span><span class="nx">mapVideos</span><span class="p">,</span> <span class="nx">prop</span><span class="p">(</span><span class="s1">&#39;items&#39;</span><span class="p">));</span>

<span class="nx">toVideos</span><span class="p">({</span> <span class="nx">items</span><span class="o">:</span> <span class="p">[{</span> <span class="nx">id</span><span class="o">:</span> <span class="mi">1</span> <span class="p">},</span> <span class="p">{</span> <span class="nx">id</span><span class="o">:</span> <span class="mi">2</span> <span class="p">}]});</span> <span class="c1">//=&gt; [{ id: 1 }, { id: 2 }]</span>
<span class="nx">toVideos</span><span class="p">({</span> <span class="nx">items</span><span class="o">:</span> <span class="p">[]});</span> <span class="c1">//=&gt; []</span>
</code></pre></div>

<h2 id="building-a-function-to-search-videos">Building a function to search videos</h2>

<p>Let’s recap what we have so far.</p>

<p>A function <code>makeUrl</code> that takes user input <code>String</code> and outputs an <code>Url</code>:</p>

<div class="highlight"><pre><code class="js"><span class="c1">// makeUrl :: String -&gt; Url</span>
<span class="kr">const</span> <span class="nx">makeUrl</span> <span class="o">=</span> <span class="p">(</span><span class="nx">term</span><span class="p">)</span> <span class="o">=&gt;</span>
  <span class="err">`</span><span class="nx">https</span><span class="o">:</span><span class="c1">//www.googleapis.com/youtube/v3/search?part=snippet&amp;maxResults=24&amp;type=video&amp;q=${term}&amp;key=&#39;xxxx&#39;`;</span>
</code></pre></div>

<p>A function <code>toVideos</code> that takes <code>ResponseJSON</code> and outputs <code>[Video]</code>.</p>

<div class="highlight"><pre><code class="js"><span class="c1">// toVideos :: ResponseJSON -&gt; [Video]</span>
<span class="kr">const</span> <span class="nx">toVideos</span> <span class="o">=</span> <span class="nx">compose</span><span class="p">(</span><span class="nx">mapVideos</span><span class="p">,</span> <span class="nx">prop</span><span class="p">(</span><span class="s1">&#39;items&#39;</span><span class="p">));</span>
</code></pre></div>

<p>So we just need a function that can take in <code>Url</code> and output <code>ResponseJSON</code>. Well, it’s not as simple as that
since we are dealing with an API call that goes over the network. In this case, I am opting to use
the <a href="https://github.com/folktale/data.task"><code>Task</code></a> type, which represents a delayed computation. Think
of it as a Promise, but does not have an effect right away.</p>

<p>Usage example:</p>

<div class="highlight"><pre><code class="js"><span class="c1">// Create new task that will resolve with &#39;hello&#39; after 100 ms</span>
<span class="kr">const</span> <span class="nx">t</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Task</span><span class="p">((</span><span class="nx">reject</span><span class="p">,</span> <span class="nx">resolve</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">resolve</span><span class="p">(</span><span class="s1">&#39;hello!&#39;</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="p">});</span>

<span class="c1">// The effect only happens when `fork` is called.</span>
<span class="nx">t</span><span class="p">.</span><span class="nx">fork</span><span class="p">(</span>
  <span class="c1">// Rejected handler</span>
  <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">x</span><span class="p">),</span>

  <span class="c1">// Resolved handler</span>
  <span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>

<p>So we define a function <code>httpGet</code> as follows.</p>

<div class="highlight"><pre><code class="js"><span class="c1">// httpGet :: String -&gt; Task Error ResponseJSON</span>
<span class="kr">const</span> <span class="nx">httpGet</span> <span class="o">=</span> <span class="p">(</span><span class="nx">url</span><span class="p">)</span> <span class="o">=&gt;</span>
  <span class="k">new</span> <span class="nx">Task</span><span class="p">((</span><span class="nx">rej</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span>
    <span class="nx">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">)</span>
      <span class="c1">// Since json() returns another promise,</span>
      <span class="c1">// we need to chain it down to the resolve function.</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">resp</span><span class="p">)</span> <span class="o">=&gt;</span>
        <span class="nx">resp</span><span class="p">.</span><span class="nx">json</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span>
      <span class="p">)</span>
      <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">rej</span><span class="p">)</span>
  <span class="p">);</span>
</code></pre></div>

<p>And then we can define the final <code>searchVideos</code> function as follows.</p>

<div class="highlight"><pre><code class="js"><span class="c1">// searchVideos :: String -&gt; Task Error [Video]</span>
<span class="kr">export</span> <span class="kr">const</span> <span class="nx">searchVideos</span> <span class="o">=</span> <span class="nx">compose</span><span class="p">(</span><span class="nx">lift</span><span class="p">(</span><span class="nx">toVideos</span><span class="p">),</span> <span class="nx">httpGet</span><span class="p">,</span> <span class="nx">makeUrl</span><span class="p">);</span>
</code></pre></div>

<div class="alert alert-info">
<p>
<strong>Note:</strong> that I am using a <a href="http://ramdajs.com/0.19.0/docs/#lift"><code>lift</code></a>
function inside the composition. This is
needed since the return type of <code>httpGet</code> is <code>Task Error ResponseJSON</code>, we
need to lift the <code>ResponseJSON -&gt; [Video]</code> transformation function into
a function that can operate on the value inside the Task.
</p>
<p>
The type for <code>lift(toVideos)</code> is <code>M ResponseJSON -&gt; M [Video]</code>, where
<code>M</code> is a mappable object -- in this case we are using a Task.
</p>
</div>

<h2 id="wiring-up-the-ui">Wiring up the UI</h2>

<p>Now comes the easy part of putting the UI togther to use the <code>searchVideos</code> function
we just composed.</p>

<p>Here is the main <code>App</code> component:</p>

<div class="highlight"><pre><code class="js"><span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
    <span class="c1">// Keep the results in app state</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">results</span><span class="o">:</span> <span class="p">[]</span> <span class="p">};</span>
  <span class="p">}</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">VideoSearch</span>
        <span class="nx">onSearch</span><span class="o">=</span><span class="p">{(</span><span class="nx">term</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="c1">// Returns type `Task Error [Videos]`</span>
          <span class="nx">searchVideos</span><span class="p">(</span><span class="nx">term</span><span class="p">).</span><span class="nx">fork</span><span class="p">(</span>
            <span class="c1">// If there is an error, just log it.</span>
            <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">e</span><span class="p">),</span>

            <span class="c1">// Otherwise, update app state.</span>
            <span class="p">(</span><span class="nx">results</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="nx">results</span> <span class="p">})</span>
          <span class="p">)</span>
        <span class="p">}}</span>
        <span class="nx">results</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">results</span><span class="p">}</span><span class="o">/&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>And here is the less interesting <code>VideoSearch</code> component.</p>

<div class="highlight"><pre><code class="js"><span class="kr">const</span> <span class="nx">VideoSearch</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">onSearch</span><span class="p">,</span> <span class="nx">results</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">(</span>
  <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">&quot;Search for videos&quot;</span>
           <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span> <span class="p">({</span> <span class="nx">target</span><span class="o">:</span> <span class="nx">t</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="nx">onSearch</span><span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span> <span class="p">}</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
      <span class="p">{</span> <span class="nx">results</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">v</span> <span class="o">=&gt;</span> <span class="p">(</span>
          <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">v</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">Embed</span> <span class="nx">video</span><span class="o">=</span><span class="p">{</span><span class="nx">v</span><span class="p">}</span><span class="o">/&gt;</span>
          <span class="o">&lt;</span><span class="err">/div&gt;</span>
      <span class="p">))</span> <span class="p">}</span>
    <span class="o">&lt;</span><span class="err">/div&gt;</span>
  <span class="o">&lt;</span><span class="err">/div&gt;</span>
<span class="p">);</span>
</code></pre></div>

<p>The main thing to note is that the both the <code>App</code> and <code>Search</code> videos components are very simple.
All of the complexity is delegated to the <code>searchVideos</code> function, which as we’ve seen, is made up
of a bunch of smaller, simple functions.</p>


    </div>
    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/2016/01/03/managing-processes-in-redux-using-sagas" title="Managing Side Effects In React + Redux Using Sagas">&larr; Previous</a></li>
      
        <li><a href="/archive.html">Archive</a></li>
      
        <li class="next disabled"><a>Next &rarr;</a>
      
      </ul>
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'jaysoo';
    var disqus_identifier = '/2016/01/12/functional-programming-little-ideas';
    var disqus_url = 'http://jaysoo.ca/2016/01/12/functional-programming-little-ideas';
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  </div>

  <aside class="span4">
    <h4>Published</h4>
    <div class="box date"><span>12 January 2016</span></div>

  
    <h4>Tags</h4>
    <ul class="box tag_box">
    
    


  
     
    	<li><a href="/tags.html#functional programming-ref">functional programming <span>1</span></a></li>
     
    	<li><a href="/tags.html#javascript-ref">javascript <span>31</span></a></li>
     
    	<li><a href="/tags.html#react-ref">react <span>4</span></a></li>
    
  



    </ul>
  

    <h4>Share</h4>
    <div class="box">
      <a href="https://twitter.com/share?url=http://jaysoo.ca/2016/01/12/functional-programming-little-ideas&amp;text=The%20Little%20Idea%20of%20Functional%20Programming&amp;via=jay_soo" class="twitter-share-button"{count} data-via="jay_soo" data-size="large">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
    </div>

    <h4>Related Posts</h4>
    <ul>
      
      <li><a href="/2016/01/03/managing-processes-in-redux-using-sagas">Managing Side Effects In React + Redux Using Sagas</a></li>
      
      <li><a href="/2015/09/26/typed-react-and-redux">React and Redux with TypeScript</a></li>
      
      <li><a href="/2015/06/09/react-contexts-and-dependency-injection">React Contexts and Dependency Injection</a></li>
      
      <li><a href="/2015/11/21/avoid-unnecessary-indirection">Avoid Unnecessary Indirection</a></li>
      
      <li><a href="/2015/06/02/why-you-should-care-about-flux">Why You Should Care About Flux</a></li>
      
    </ul>
  </aside>
</div>


        </div>
      </div>
    </div> <!-- /#main -->

    <footer class="page-footer">
      <div class="container-fluid">
        <h3>About Jack <i class="fa fa-asterisk"></i></h3>

        <p>
          I am a Toronto-based software engineer. My interests are in client-side
          applications, Functional Programming, and Reactive Systems.
          You may reach me via email at jack.hsu@gmail.com.
        </p>

        <ul class="social-links">
          <li>
            <a href="https://twitter.com/jay_soo"><i class="fa fa-twitter"></i></a>
          </li>
          <li>
            <a href="https://github.com/jaysoo"><i class="fa fa-github"></i></a>
          </li>
          <li>
            <a href="https://linkedin.com/in/jackhsu83"><i class="fa fa-linkedin"></i></a>
          </li>
          <li>
            <a href="https://plus.google.com/+JackHsu83/"><i class="fa fa-google-plus"></i></a>
          </li>
          <li>
            <a href="https://stackoverflow.com/users/70871/jay-soo"><i class="fa fa-stack-overflow"></i></a>
          </li>
          <li>
            <a href="http://instagram.com/jaysoo3"><i class="fa fa-instagram"></i></a>
          </li>
        </ul>
        <p class="info"><small>&copy; Jack Hsu 2016</p>
      </div>
    </footer>

    


  <script>
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-300789-3']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>






    <script src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script src="/assets/application-c6356f852c51c4ac2c625fba60764e43.js"></script>
    
  </body>
</html>

